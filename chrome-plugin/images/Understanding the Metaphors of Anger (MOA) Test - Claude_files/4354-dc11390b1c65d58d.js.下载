"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4354],{94354:function(e,t,n){n.d(t,{$H:function(){return Q},$Y:function(){return U},CJ:function(){return T},Gk:function(){return N},Ke:function(){return S},Ls:function(){return I},PD:function(){return A},QR:function(){return k},Rq:function(){return w},W:function(){return z},_C:function(){return P},cj:function(){return F},gK:function(){return q},hA:function(){return b},j1:function(){return x},j7:function(){return M},jl:function(){return K},lg:function(){return O},o:function(){return C},yj:function(){return E},zU:function(){return B}});var a=n(6700),r=n(83041),i=n(16096),u=n(17179),s=n(35146),o=n(36665),l=n(28505),c=n(84983),d=n(74822),g=n(11064),v=n.n(g),_=n(99733),p=n.n(_),h=n(54603),f=n(7653),m=n(80248),y=n(50504);let C=(e,t)=>{let{activeOrganization:n}=(0,i.useCurrentAccount)(),a=null==n?void 0:n.uuid;return(0,r.WE)("/api/organizations/".concat(a,"/chat_conversations/").concat(e,"/chat_messages/").concat(t,"/debug"),{queryKey:[s.Ep,{orgUUID:a},{conversationUuid:e},{messageUuid:t}],enabled:!!t})},b=function(e){let{suppressError:t,enabled:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:a}=(0,i.useCurrentAccount)(),u=null==a?void 0:a.uuid;return(0,r.WE)("/api/organizations/".concat(null!=u?u:"","/chat_conversations/").concat(e),{queryKey:[s.ph,{orgUUID:u},{uuid:e}],staleTime:3e5,enabled:!!u&&!!e&&n,select:e=>({...e,chat_messages:p()(e.chat_messages,"index")}),meta:{noToast:t}})},w=e=>{let t=(0,c.useQueryClient)(),{activeOrganization:n}=(0,i.useCurrentAccount)(),{value:a}=(0,m.useGate)("apps_edit_messages"),r=null==n?void 0:n.uuid,[u,l]=(0,f.useReducer)(e=>e+1,0),g=(0,o.B)([a?s.I8:s.ph,{orgUUID:r},{uuid:e}]),v=(0,f.useMemo)(()=>t.getQueryData(g),[t,g,e,u]);return(0,f.useEffect)(()=>t.getQueryCache().subscribe(e=>{"updated"===e.type&&"success"===e.action.type&&(0,d._x)({queryKey:g},e.query)&&l()}),[t,l,g]),{data:v}},k=()=>{let{activeOrganization:e}=(0,i.useCurrentAccount)(),t=null==e?void 0:e.uuid;return(0,r.WE)("/api/organizations/".concat(null!=t?t:"","/chat_conversations"),{queryKey:[s.tv,{orgUUID:t}],staleTime:3e5,enabled:!!t,select:e=>p()(e,e=>new Date(e.updated_at)).reverse()})},P=function(e){let{suppressError:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,i.useCurrentAccount)(),a=null==n?void 0:n.uuid,u=(0,f.useRef)([]),o="/api/organizations/".concat(null!=a?a:"","/chat_conversations/").concat(e,"?tree=True&rendering_mode=raw"),l=(0,r.WE)(o,{queryKey:[s.I8,{orgUUID:a},{uuid:e}],staleTime:3e5,enabled:!!a&&!!e,meta:{noToast:t}},y.fX),c=(0,f.useMemo)(()=>{if(!l.data)return u.current=[],u.current;let e=(0,y.kX)(l.data);if(e.length!==u.current.length||e.some((e,t)=>{var n;return e.uuid!==(null===(n=u.current[t])||void 0===n?void 0:n.uuid)}))return u.current=e,u.current;for(let t=0;t<e.length;t++)v()(e[t],u.current[t])||(u.current[t]=e[t]);return u.current},[l.data]);return{...l,currentPath:c}},Q=(e,t)=>{let{mutate:n}=U(),a=(0,h.useRouter)(),r=t||(0,l.H)();return(0,f.useCallback)(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{model:void 0,controlsOpen:!1};n({uuid:r,name:"",model:t.model});let i="/chat/".concat(r).concat(t.controlsOpen?"?controls=1":"");a[e](i)},[n,a,e,r])},U=()=>{let{activeOrganization:e}=(0,i.useCurrentAccount)(),t=null==e?void 0:e.uuid,n=(0,c.useQueryClient)(),{value:a}=(0,m.useGate)("apps_edit_messages"),u=[s.tv,{orgUUID:t}],o=e=>[s.ph,{orgUUID:t},{uuid:e}],l=e=>[s.I8,{orgUUID:t},{uuid:e}];return(0,r.uC)("/api/organizations/".concat(null!=t?t:"","/chat_conversations"),"POST",{enabled:!!t,async onMutate(e){let t=o(e.uuid),a={summary:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),...e};await Promise.all([n.cancelQueries({queryKey:u}),n.cancelQueries({queryKey:t})]),n.setQueryData(u,e=>e&&[a,...e]),n.setQueryData(t,e=>({...e||{},...a,chat_messages:(null==e?void 0:e.chat_messages)||[]}))},onSuccess:e=>{n.setQueryData(u,t=>{if(!t)return;let n=t.findIndex(t=>t.uuid===e.uuid);if(-1===n)return t;let a=[...t];return a.splice(n,1,e),a}),a?n.setQueryData(l(e.uuid),t=>({...t||{},...e,chat_messages:(null==t?void 0:t.chat_messages)||[],messageByUuid:new Map,parentByChildUuid:new Map,childrenByParentUuid:new Map,selectedChildByUuid:new Map})):n.setQueryData(o(e.uuid),t=>({...t||{},...e,chat_messages:(null==t?void 0:t.chat_messages)||[]}))},onError(e,t){n.setQueryData(u,e=>null==e?void 0:e.filter(e=>e.uuid!==t.uuid)),n.setQueryData(o(t.uuid),void 0)}})},x=()=>{let{activeOrganization:e}=(0,i.useCurrentAccount)(),t=null==e?void 0:e.uuid,{value:n}=(0,m.useGate)("apps_edit_messages"),a=(0,c.useQueryClient)();return(0,r.Ne)(e=>"/api/organizations/".concat(null!=t?t:"","/chat_conversations/").concat(e),"DELETE",(e,t)=>{if(!t)return[];let n=t.findIndex(t=>t.uuid===e);if(!(n>-1))return t;{let e=[...t];return e.splice(n,1),e}},{enabled:!!t,queryKey:[s.tv,{orgUUID:t}],onSuccess:async(e,r)=>{await a.invalidateQueries([n?s.I8:s.ph,{orgUUID:t},{uuid:r}])}})},E=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid,a=null==t?void 0:t.capabilities.includes("raven");return(0,r.WE)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/shares"),{queryKey:[s.zb,{orgUUID:n,conversationUUID:e}],enabled:!!n&&a,staleTime:3e5})},T=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid;return(0,r.WE)("/api/organizations/".concat(n,"/chat_snapshots/").concat(e),{retry:!1,refetchInterval:!1,enabled:!!e,queryKey:[s.ld,{orgUUID:n,snapshotUUID:e}]})},A=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid,a=(0,c.useQueryClient)(),{data:u}=w(e);return(0,r.Ne)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/share"),"POST",(e,t)=>{let n=null==u?void 0:u.chat_messages.findIndex(e=>e.uuid===(null==u?void 0:u.current_leaf_message_uuid));if(!n)return t;let a={uuid:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),snapshot_name:null==u?void 0:u.name,last_message_index:n,...e};return t?[...t,a]:[a]},{onSuccess:t=>{a.invalidateQueries([s.zb,{orgUUID:n,conversationUUID:e}]),a.invalidateQueries([s.ld,{orgUUID:n,snapshotUUID:t.uuid}]),a.invalidateQueries([s.VH,{orgUUID:n}])},queryKey:[s.zb,{orgUUID:n,conversationUUID:e}],meta:{errorMessage:"There was an error while trying to share the conversation. Please try again."}})},I=(e,t)=>{let{activeOrganization:n}=(0,i.useCurrentAccount)(),a=null==n?void 0:n.uuid,u=(0,c.useQueryClient)();return(0,r.Ne)("/api/organizations/".concat(a,"/share/").concat(t),"DELETE",(e,n)=>{if(!n)return[];let a=n.findIndex(e=>e.uuid===t);if(!(a>-1))return n;{let e=[...n];return e.splice(a,1),e}},{enabled:!!a,queryKey:[s.zb,{orgUUID:a,conversationUUID:e}],onSuccess:()=>{u.invalidateQueries([s.zb,{orgUUID:a,conversationUUID:e}]),u.invalidateQueries([s.ld,{orgUUID:a,snapshotUUID:t}]),u.invalidateQueries([s.VH,{orgUUID:a}])},meta:{errorMessage:"There was an error while trying to unshare the conversation. Please try again."}})},S=(e,t,n)=>{var o,l,d;let{track:g}=(0,a.z$)(),v=null!==(l=null===(o=(0,u.T)())||void 0===o?void 0:o.preview_feature_uses_artifacts)&&void 0!==l&&l,{activeOrganization:_}=(0,i.useCurrentAccount)(),p=null==_?void 0:_.uuid,{value:h}=(0,m.useGate)("apps_edit_messages"),f=(0,c.useQueryClient)(),y=[h?s.I8:s.ph,{orgUUID:p},{uuid:e}];return(0,r.uC)("/api/organizations/".concat(null!=p?p:"","/chat_conversations/").concat(e,"/chat_messages/").concat(null!==(d=t.uuid)&&void 0!==d?d:"","/chat_feedback"),t.chat_feedback?"PUT":"POST",{enabled:!!p,meta:{errorMessage:"We could not save your feedback. Please try again later."},onSuccess(){var a;g({event_key:"claudeai.conversation.feedback.sent",message_uuid:t.uuid,conversation_uuid:e,artifacts_enabled:v,conversationHasArtifacts:n,type:null===(a=t.chat_feedback)||void 0===a?void 0:a.type}),f.invalidateQueries(y)}})},D=()=>{let e=(0,c.useQueryClient)(),{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid,{value:a}=(0,m.useGate)("apps_edit_messages");return(0,f.useCallback)((t,r)=>{t&&(e.setQueryData([a?s.I8:s.ph,{orgUUID:n},{uuid:t}],e=>e&&{...e,...r}),e.setQueryData([s.tv,{orgUUID:n}],e=>null==e?void 0:e.map(e=>e.uuid!==t?e:{...e,...r})))},[n,e,a])},z=e=>{let t=(0,c.useQueryClient)(),{activeOrganization:n}=(0,i.useCurrentAccount)(),a=null==n?void 0:n.uuid,{value:u}=(0,m.useGate)("apps_edit_messages"),o=D();return(0,r.uC)("/api/organizations/".concat(a,"/chat_conversations/").concat(e),"PUT",{onMutate:n=>{var r;let{name:i}=n,l=t.getQueryData([u?s.I8:s.ph,{orgUUID:a},{uuid:e}]);return o(e,{name:i}),{oldTitle:null!==(r=null==l?void 0:l.name)&&void 0!==r?r:""}},onError(t,n,a){a&&o(e,{name:a.oldTitle})}})},B=e=>{let t=(0,c.useQueryClient)(),{activeOrganization:n}=(0,i.useCurrentAccount)(),a=null==n?void 0:n.uuid,{value:u}=(0,m.useGate)("apps_edit_messages"),o=D();return(0,r.uC)("/api/organizations/".concat(a,"/chat_conversations/").concat(e),"PUT",{onMutate:n=>{let{model:r}=n,i=t.getQueryData([u?s.I8:s.ph,{orgUUID:a},{uuid:e}]);return o(e,{model:r}),{oldModel:null==i?void 0:i.model}},onError(t,n,a){a&&o(e,{model:a.oldModel})}})},M=e=>{let t=D(),{activeOrganization:n}=(0,i.useCurrentAccount)();return(0,r.uC)("/api/organizations/".concat(null==n?void 0:n.uuid,"/chat_conversations/").concat(e,"/title"),"POST",{onSuccess(n){let{title:a}=n;t(e,{name:null!=a?a:""})},meta:{noToast:!0}})};function O(e){return e.text+e.attachments.map(e=>e.extracted_content).join(" ")}let q=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid;return(0,r.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/stop_response"),"POST")},K=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid;return(0,r.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/current_leaf_message_uuid"),"PUT")},N=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=(0,c.useQueryClient)(),a=null==t?void 0:t.uuid;return(0,r.Ne)("/api/organizations/".concat(a,"/chat_conversations/").concat(e),"PUT",(e,t)=>t?{...t,...e}:void 0,{onSuccess:()=>{n.invalidateQueries([s.tv,{orgUUID:a}]),n.invalidateQueries([s.I8,{orgUUID:a},{uuid:e}])},queryKey:[s.I8,{orgUUID:a},{uuid:e}]})},F=()=>{let{data:e,isLoading:t}=k();return{data:null==e?void 0:e.filter(e=>e.is_starred),isLoading:t}}},50504:function(e,t,n){n.d(t,{FC:function(){return u},HX:function(){return v},QC:function(){return o},fX:function(){return g},kX:function(){return p},mj:function(){return h},vv:function(){return _},wZ:function(){return s}});var a=n(43316),r=n(88253),i=n.n(r);let u="new-assistant-message-uuid",s="new-human-message-uuid",o="00000000-0000-4000-8000-000000000000";function l(e,t){let n=e.get(t);if(void 0===n){let e=Error("Key not found: ".concat(t));throw(0,a.Tb)(e),e}return n}let c=(e,t)=>{let n=null!=t?t:e.current_leaf_message_uuid;if(!n)return e;for(;n!==o;){var a;let t=l(e.parentByChildUuid,n),r=null===(a=l(e.childrenByParentUuid,t))||void 0===a?void 0:a.indexOf(n);e.selectedChildByUuid.set(t,r),n=t}return{...e,current_leaf_message_uuid:t}},d=e=>{var t,n,a;let r=new Map,i=new Map,u=new Map,s=new Map,l=new Map;if(0===e.chat_messages.length)return{messageByUuid:i,parentByChildUuid:u,childrenByParentUuid:s,selectedChildByUuid:l};for(let t of e.chat_messages)r.set(t.index,t),i.set(t.uuid,t);for(let t of e.chat_messages){let e=t.parent_message_uuid;if(!e){let a=t.index-1;for(;!e&&a>=0;)e=null===(n=r.get(a))||void 0===n?void 0:n.uuid,a--}e=null!=e?e:o,u.set(t.uuid,e),s.set(e,(null!==(a=s.get(e))&&void 0!==a?a:[]).concat(t.uuid)),l.set(e,0)}if(!(null===(t=s.get(o))||void 0===t?void 0:t[0]))throw Error("No root message found");return{messageByUuid:i,parentByChildUuid:u,childrenByParentUuid:s,selectedChildByUuid:l}},g=e=>{let t={...e,...d(e)};return t.current_leaf_message_uuid||c(t),c(t,e.current_leaf_message_uuid)},v=e=>{let t=Array.from(e.messageByUuid.values()).map(e=>e.index);return 0===t.length?-1:Math.max(...t)},_=(e,t)=>{for(let a of(e.chat_messages=e.chat_messages.concat(t),t)){var n;if(!a.parent_message_uuid)throw Error("Parent UUID required");let t=a.parent_message_uuid;e.messageByUuid.set(a.uuid,a),e.parentByChildUuid.set(a.uuid,t);let r=null!==(n=e.childrenByParentUuid.get(t))&&void 0!==n?n:[];r.push(a.uuid),e.childrenByParentUuid.set(t,r),e.selectedChildByUuid.set(t,r.length-1)}return c(e,t[t.length-1].uuid)},p=(e,t)=>{let n=[],a=null!=t?t:o;for(;e.childrenByParentUuid.has(a);){let t=l(e.childrenByParentUuid,a);if(0===t.length)break;let r=l(e.selectedChildByUuid,a),i=l(e.messageByUuid,t[r]);n.push({...i,parent_message_uuid:a,nOptions:t.length,selectedOption:r}),a=i.uuid}return n};function h(e,t,n){var a;let r=l(e.parentByChildUuid,t.uuid),u=l(e.childrenByParentUuid,r),s=i()((null!==(a=t.selectedOption)&&void 0!==a?a:0)+n,0,u.length-1);e.selectedChildByUuid.set(r,s);let o=p(e,r);return c(e,o[o.length-1].uuid)}},6700:function(e,t,n){n.d(t,{YZ:function(){return d},z$:function(){return c}});var a=n(28648),r=n(7653),i=n(83041),u=n(11492),s=n(16096),o=n(89937);let l={"ts.eu_election_banner.shown":{version:1,data_team_tag:"ts"},"ts.banner.shown":{version:1,data_team_tag:"ts"},"billing.credit_card.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.contact_sales.completed":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.contact_sales.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.payment_info.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.payment_info.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.setup_billing.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.setup_billing.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire_manual.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.select_plan.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.select_plan.completed":{version:1,data_team_tag:"billing_funnel"},"evals.revision.created":{version:1},"evals.show_prompt_preview.toggled":{version:1},"evals.run_all.submitted":{version:1},"evals.test_case.run.submitted":{version:1},"evals.test_case.run.completed":{version:1},"evals.test_case.run.failed":{version:1},"evals.test_case.create.submitted":{version:1},"evals.test_case.delete.submitted":{version:1},"evals.select_revision.clicked":{version:1},"evals.test_case.update_rating.submitted":{version:1},"evals.comparison.add_button.clicked":{version:1},"evals.comparison.remove_button.clicked":{version:1},"evals.comparison.other_revision.selected":{version:1},"test_case_generator.generate.started":{version:1},"test_case_generator.edit_logic.clicked":{version:1},"metaprompter.modal.loaded":{version:1},"metaprompter.example.selected":{version:1},"metaprompter.generate.started":{version:1},"metaprompter.generate.stop.attempted":{version:1},"metaprompter.generate.finished":{version:1},"metaprompter.start_editing.clicked":{version:1},"onboarding.invite_accept_page.invite_accept.submitted":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.invite_accept_page.invite_reject.submitted":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.invite_accept_page.loaded":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.organization_create.loaded":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.organization_create.submitted":{version:1,data_team_tag:"onboarding_funnel"},"workbench.tab_selection.clicked":{version:1},"workbench.variables_pane.loaded":{version:1},"claudeai.projects.list_view.switched":{version:1},"claudeai.conversation.suggestion.applied":{version:1},"claudeai.conversation.recent.opened":{version:1},"claudeai.projects.activity.shared_conversation.opened":{version:1},"claudeai.settings.preview_feature.toggled":{version:1},"claudeai.settings.preview_feature.opened":{version:1},"claudeai.support.opened":{version:1},"claudeai.conversation.feedback.sent":{version:1}},c=()=>{let e=(0,o.K)(),{account:t,activeOrganization:n,isLoading:a}=(0,s.useCurrentAccount)(),i=(0,u.useIsClaudeDot)(),c=(0,r.useCallback)(r=>{if(a)return;let{event_key:u,...s}=r;return e.track(u,{account_uuid:null==t?void 0:t.uuid,organization_uuid:null==n?void 0:n.uuid,billing_type:null==n?void 0:n.billing_type,surface:i?"claude-ai":"console",...l[u],...s})},[e,t,n,i,a]);return(0,r.useMemo)(()=>({track:c}),[c])},d=(e,t,n,r)=>{let u=c(),{onSuccess:s,onError:o,...l}=r||{};return(0,i.uC)(t,n,{onSuccess(){for(var t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];u.track({event_key:e,result:"success"}),null==s||s(...n)},onError(t){let n;for(var r=arguments.length,i=Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];t instanceof a.Hx&&(n=t.type),u.track({event_key:e,result:"failure",failure_reason:n}),null==o||o(t,...i)},...l})}},83243:function(e,t,n){var a,r;n.d(t,{DF:function(){return u},iw:function(){return i}}),(r=a||(a={})).GoogleTagManager="google_tag_manager",r.GoogleEnhancedConversions="google_enhanced_conversions";let i={analytics:!1,marketing:!1},u={analytics:!0,marketing:!0}},17179:function(e,t,n){n.d(t,{I:function(){return s},T:function(){return u}});var a=n(27573),r=n(7653);let i=(0,r.createContext)(null),u=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useCurrentConversationSettings must be used within a CurrentConversationSettingsProvider");return e},s=e=>{let{children:t,settings:n}=e;return(0,a.jsx)(i.Provider,{value:n,children:t})}},89937:function(e,t,n){n.d(t,{K:function(){return u}});var a=n(80248),r=n(11492),i=n(21728);let u=()=>{let{segmentKey:e,segmentCdnHost:t,segmentApiHost:n}=(0,r.useConfiguration)(),{value:u}=(0,a.useGate)("requires_explicit_consent");return i.u.loadIfNecessary({segmentKey:e,segmentCdnHost:t,segmentApiHost:n,requiresExplicitConsent:u})}},21728:function(e,t,n){n.d(t,{u:function(){return v}});var a=n(14983),r=n(70478),i=n(39625),u=n(43316),s=n(27794),o=n.n(s),l=n(83243),c=n(23532);class d{constructor(){this.name="RemoveUserAgent",this.version="1.0.0",this.type="before",this.isLoaded=()=>!0,this.load=()=>Promise.resolve(),this.redactPiiFromContext=e=>{var t;return(null==e?void 0:null===(t=e.event)||void 0===t?void 0:t.context)&&(delete e.event.context.userAgent,delete e.event.context.email,e.event.context.ip="REDACTED"),e},this.track=this.redactPiiFromContext,this.identify=this.redactPiiFromContext,this.page=this.redactPiiFromContext,this.group=this.redactPiiFromContext,this.alias=this.redactPiiFromContext,this.screen=this.redactPiiFromContext}}class g{constructor(){this.consentChangedCallback=o(),this.preferences=g.mapConsentPreferences(l.iw),this.analyticsBrowser=null,this.loadIfNecessary=e=>{let{segmentKey:t,segmentCdnHost:n,segmentApiHost:a,requiresExplicitConsent:r}=e;return this.analyticsBrowser||(this.analyticsBrowser=new i.b,this.loadInitialConsentPreferences(r),this.wrapAnalyticsWithConsent(this.analyticsBrowser).load({writeKey:t,cdnURL:"https://".concat(n),plugins:[new d]},{disableClientPersistence:!0,integrations:{"Segment.io":{apiHost:"".concat(a,"/v1"),protocol:"https"}}}).catch(e=>{(0,u.Tb)(e,{extra:{message:"Failed to load analytics"}})})),this.analyticsBrowser},this.registerOnConsentChanged=e=>{this.consentChangedCallback=e},this.getCategories=()=>this.preferences,this.loadInitialConsentPreferences=e=>{let t;try{t=c.browserCookieStore.get(a.cn.CONSENT_PREFERENCES)}catch(e){(0,u.Tb)(e,{extra:{message:"Failed to get consent preferences cookie"}})}if(t)try{let e=JSON.parse(t);this.preferences=g.mapConsentPreferences(e)}catch(e){console.warn("Malformed consent preferences cookie",t)}else e||(this.preferences=g.mapConsentPreferences(l.DF))},this.updateCategories=e=>{this.preferences=g.mapConsentPreferences(e),this.consentChangedCallback(this.preferences)},this.wrapAnalyticsWithConsent=e=>(0,r.K)({registerOnConsentChanged:this.registerOnConsentChanged,getCategories:this.getCategories})(e)}}g.mapConsentPreferences=e=>({marketing:e.marketing,analytics:e.analytics,necessary:!0});let v=new g},36665:function(e,t,n){n.d(t,{B:function(){return r}});var a=n(7653);function r(e){let t=JSON.stringify(e);return(0,a.useMemo)(()=>e,[t])}},28505:function(e,t,n){n.d(t,{H:function(){return a}});let a=()=>void 0===crypto.randomUUID?"".concat(1e7,"-",1e3,"-",4e3,"-",8e3,"-",1e11).replace(/[018]/g,e=>{let t=parseInt(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}):crypto.randomUUID()}}]);